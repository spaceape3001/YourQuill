////////////////////////////////////////////////////////////////////////////////
//
//  YOUR QUILL
//
////////////////////////////////////////////////////////////////////////////////

#pragma once

namespace {

    //  -----------------------------------------------------------------------
    //      UTILITIES
    //  -----------------------------------------------------------------------
    
    //  -----------------------------------------------------------------------
    //      REST API
    //  -----------------------------------------------------------------------

    //  -----------------------------------------------------------------------
    //      PAGES
    //  -----------------------------------------------------------------------
    
    //  -----------------------------------------------------------------------
    //      ADMIN
    //  -----------------------------------------------------------------------


    //  -----------------------------------------------------------------------
    //      DEV
    //  -----------------------------------------------------------------------

        void    p_dev_doodle(WebHtml& h)
        {
            Doodle   x = doodle(h);
            if(!x)
                throw HttpStatus::BadArgument;
            auto i = cdb::nki(x);
            dev_title(h, x);
            auto ta = h.table();
            h.kvrow("ID") << x.id;
            h.kvrow("Title") << i.name;
            h.kvrow("Key") << i.key;
            h.kvrow("Fragment") << dev(cdb::fragment(x));
        }

        void    p_dev_doodles(WebHtml& out)
        {
            out.title("All Doodles");
            dev_table(out, all_doodles());
        }

    //  -----------------------------------------------------------------------
    //      REGISTRATION
    //  -----------------------------------------------------------------------

        void reg_doodle_pages()
        {
            reg_webpage<p_dev_doodle>("/dev/doodle").local().argument("id", "Doodle id (number)");
            reg_webpage<p_dev_doodles>("/dev/doodles");
        }
}
